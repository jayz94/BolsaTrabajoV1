@model IEnumerable<BolsaTrabajoV1.Models.USUARIO>
<h2 class="text-center">USUARIOS</h2>
    <!--inicia para el toggle-->
<link href="css/bootstrap.min.css" rel="stylesheet">
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script type="text/javascript">window.jQuery || document.write('<script src="classes/commons/jquery/jquery-1.7.1.min.js"><\/script>')</script>
<link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
<script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>
<script src="http://malsup.github.com/jquery.form.js"></script>
<!--fin para el toggle-->
<p>
    @Html.ActionLink("Agregar", "Create", null, new { @class = "btn btn-success" })
</p>
<table class="table">
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.NOMBREUSUARIO)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.ACTIVO)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.BLOQUEADO)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.CORREO)
        </th>
        <th>Acciones</th>
    </tr>

@foreach (var item in Model)
{
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.NOMBREUSUARIO)
        </td>
        <td>
            @{
                if (item.ACTIVO.Equals(true))
                {
                    <input type="checkbox" onchange="cambiarEstadoActivo(@item.IDUSUARIO)" id="toggle" data-toggle="toggle" data-off="NO" data-on="SI" checked>
                }
                else
                {
                    <input type="checkbox" onchange="cambiarEstadoActivo(@item.IDUSUARIO)" id="toggle" data-toggle="toggle" data-off="NO" data-on="SI">
                }

            }
        </td>
        <td>
            @{
                if (item.INTENTOS >= 5)
                {
                    <input type="checkbox" onchange="desbloquearIntentos(@item.IDUSUARIO)" id="@item.IDUSUARIO" data-toggle="toggle" data-off=".." data-on="SI" checked>
                }
                else
                {
                    <h5>.</h5>
                }

            }
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.CORREO)
        </td>
        <td>
            @Html.ActionLink(" ", "Edit", new { id = item.IDUSUARIO }, new { @class = "btn btn-success fa fa-edit btn-xs" })
            @Html.ActionLink(" ", "Details", new { id = item.IDUSUARIO}, new { @class = "btn btn-primary fa fa-search btn-xs" } ) 
            @Html.ActionLink(" ", "Delete", new { id = item.IDUSUARIO }, new { @class = "btn btn-danger fa fa-trash btn-xs" })
        </td>
    </tr>
}
</table>
<script>
    function cambiarEstadoActivo(id){
        $.ajax({
            type:'POST',
            //dataType:'JSON',
            url:'Usuario/CambiarEstadoUsuario/'+id,
            success:function(data)
            {
            }
        });
    }

    function desbloquearIntentos(id) {
        $.ajax({
            type:'POST',
            //dataType:'JSON',
            url: 'Usuario/DesbloquearIntentos/' + id,
            success:function(data)
            {
               //document.getElementById(id).type="hidden";
            }
        });
    }
</script>
